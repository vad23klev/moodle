YUI.add("moodle-course-dialogupdate",function(e,t){var n={PANELCONTENT:"#panelContentUpdate",FORMOPPONENT:"#mform1",FORMCONTAINER:"#panelContentUpdate #mform1",SUBMITBUTTON2:"#panelContentUpdate .hidden  #id_submitbutton2",SUBMITBUTTON:"#panelContentUpdate .hidden  #id_submitbutton",CANCELBUTTON:"#panelContentUpdate .hidden  #id_cancel",CANCELBUTTON2:"#panelContentUpdate .yui3-widget-hd .yui3-button.yui3-button-close",COURSEVIEW:"#page-course-view-weeks",FORM:"mform1",INITBUTTON:"a.editing_update.menu-action.cm-edit-action",DUPLICATEBUTTON:"a.editing_duplicate.menu-action.cm-edit-action",JSVALIDATE:'head script[src="http://localhost/moodle/course/moduvjs.js"]',JSFORM:'head script[src="http://localhost/moodle/course/modujs.js"]'},r="course-dialogupdate",i=function(){i.superclass.constructor.apply(this,arguments)};e.extend(i,e.Base,{change_submit:function(){e.on("domready",function(){e.one(n.SUBMITBUTTON2).on("click",this.submit_click,this)},this)},submit_click:function(t){t.preventDefault(),e.one(n.CANCELBUTTON).set("disabled","disabled"),e.one(n.SUBMITBUTTON)!==null&&e.one(n.SUBMITBUTTON).set("disabled","disabled");var r={method:"post",on:{success:this.post_success},arguments:this,form:{id:n.FORM}};e.io(M.cfg.wwwroot+"/course/modedit.php?isformajax=2",r)},post_success:function(t,r,i){if(r.responseText.indexOf(n.FORM)===-1){var s=document.URL,o={},u=s.substr(s.search("id")).split("&");for(var a in u){var f=u[a].split("=");o[decodeURIComponent(f[0])]=decodeURIComponent(f[1])}var l={on:{success:i.update_course}};e.io(M.cfg.wwwroot+"/course/view.php?id="+o.id,l)}else i.show_form(t,r)},update_course:function(e,t){document.open(),document.write(t.responseText),document.close()},show_form:function(t,r){e.one(n.PANELCONTENT)!==null&&e.one(n.PANELCONTENT).remove();var i=e.all(n.FORMOPPONENT);for(var s=0;s<i.size();s++)i.item(s).remove();e.one(n.JSVALIDATE)!==null&&(e.one(n.JSVALIDATE).remove(),e.one(n.JSFORM).remove()),panelContent=e.Node.create("<div>"),panelContent.set("id","panelContentUpdate"),e.one(n.COURSEVIEW).appendChild(panelContent),panelContent.setContent(r.responseText),e.one(n.FORMCONTAINER).setStyle("height","500"),e.one(n.FORMCONTAINER).setStyle("overflow","auto"),e.Get.js(M.cfg.wwwroot+"/lib/javascript-static.js"),e.Get.js(M.cfg.wwwroot+"/course/moduvjs.js"),e.Get.js(M.cfg.wwwroot+"/course/modujs.js");var o=new e.Panel({srcNode:n.PANELCONTENT,headerContent:"Edit",width:1e3,zIndex:5,centered:!0,modal:!0,visible:!1,render:!0,plugins:[]});e.one(n.PANELCONTENT).getY()<50&&e.one(n.PANELCONTENT).setY(50),o.show(),e.fire("domready"),e.one(n.CANCELBUTTON).on("click",function(e){e.preventDefault(),o.hide()}),e.one(n.CANCELBUTTON2).on("click",function(e){e.preventDefault(),o.hide()})},on_click:function(t,n){t.preventDefault();var r=this.get("href")+"&isformajax=2",i={on:{success:n.show_form},arguments:n};e.io(r,i)},init:function(){M.course.coursebase.register_module(this)},setupDialog:function(t,r){if(typeof t!="undefined"&&r==e.all(n.INITBUTTON).size())e.later(500,this,this.setupDialog,[t,r]);else{var i=e.all(n.INITBUTTON);for(var s=0;s<i.size();s++)i.item(s).detach("click"),i.item(s).on("click",this.on_click,i.item(s),this);this.setupDuplicate()}},setupDuplicate:function(){var t=e.all(n.DUPLICATEBUTTON),r=e.all(n.INITBUTTON).size();for(var i=0;i<t.size();i++)t.item(i).once("click",this.setupDialog,this,r)}},{NAME:r,ATTRS:{maxheight:{value:800}}}),M.course=M.course||{},M.course.dialogupdate=function(e){return new i(e)}},"@VERSION@",{requires:["io-base","io-form"]});
